<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>The Go Tripod Blog</title>
        <meta name="viewport" content="width=device-width">

       <!-- CSS (Stylesheets)
        ================================================== -->
    
        <link rel="stylesheet" href="assets/css/style.css">
        <link rel="stylesheet" href="assets/css/font-awesome.css">
        
        <!-- Google Web Fonts
        ================================================== -->
        
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Oswald">
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Cabin">
        
        <!-- Favicons
        ================================================== -->
       
        

    </head>
    <body>

        <div class="site">
          <div class="header">
            <nav id="header-navigation" class="sixteen columns" role="navigation">
            
              <ul id="navigation">
                  <li><a href="index.html#header-global" title="Home">Home</a></li>
                  <li><a href="index.html#introduction" title="About Us">About Us</a></li>
                  <li><a href="index.html#latest-work" title="Our Work">Our Work</a></li>
                  <li><a href="index.html#services" title="Our Services">Our Services</a></li>
                  <li><a href="index.html#meet-the-team" title="Meet the Team">Meet the team</a></li>
                <li><a href="#" title="Blog">Blog</a></li>
                  <li><a href="index.html#contact" title="Contact Us">Contact Us</a></li>
              </ul>
              
              <select name="dropdown" size="1" onChange="scrollTo(this.value)">
                  <option value="" selected="selected">Navigation</option>
                  <option value="index.html#header-global">Home</option>
                  <option value="index.html#introduction">About Us</option>
                  <option value="index.html#latest-work">Our Work</option> 
                  <option value="index.html#services">Our Services</option> 
                  <option value="index.html#meet-the-team">Meet the team</option>
                  <option value="#">Blog</option>
                  <option value="index.html#contact">Contact Us</option>
              </select>
              
			</nav><!-- end #header-navigation -->
          </div>
		
        <section id="blog">
          <div class="container" style="margin-bottom:30px;">
			
				<div class="icon-holder intro" style="margin:0 auto;">
					<i class="icon-book" style="color:#e47c14 !important;"></i>
				</div>
			
          <h2>Scale-9 in Objective-C Cocoa on the Mac</h2>
<p class="meta">18 Jun 2009</p>

<div class="post">
<p>Having used flash extensively for the last few years I have really come to rely on using Scale-9 scaling on UI elements in the rich internet apps I design and develop. It is a great technique for things like rounded rectangles, button graphics etc and ensuring the rounded corners do not distort when stretched.</p>

<p>I have recently been doing Cocoa Development on Mac OS X 10.5 and was looking for a way to do this in Cocoa and <a href="http://www.karlkraft.com/index.php/2007/11/14/nsdrawninepartimage/">came across</a> a great drawing method named <a href="http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Miscellaneous/AppKit_Functions/Reference/reference.html">NSDrawNinePartImage</a>. The method has the following signature:</p>

<pre lang="objc">void NSDrawNinePartImage(NSRect frame,
   NSImage *topLeftCorner,
   NSImage *topEdgeFill,
   NSImage *topRightCorner,
   NSImage *leftEdgeFill,
   NSImage *centerFill,
   NSImage *rightEdgeFill,
   NSImage *bottomLeftCorner,
   NSImage *bottomEdgeFill,
   NSImage *bottomRightCorner,
   NSCompositingOperation op,
   CGFloat alphaFraction,
   BOOL flipped
);</pre>

<p><a id="more"></a><a id="more-401"></a><br />
This method requires the developer to provide 9 separate images to create the 9 sections of the scale 9 image. Luckily the article I had stumbled across had a handy example for using a single class, so I thought that I would use their technique to create a simple generic class that can be used to draw a single NSImage as a Scale-9 scalable image. This could be used for example in an NSView or NSButtonCell.</p>

<pre lang="objc">//
//  GTDrawImage.m
//  StretchMyView
//
//  Created by Jon Baker on 17/06/2009.
//  Copyright 2009 Go Tripod Ltd. All rights reserved.
//

#import "GTDrawImage.h"

@implementation GTDrawImage

+(void) drawScalableImage:(NSImage *)sourceImage scaleTopLeft:(NSPoint)topLeftPoint scaleBottomRight:(NSPoint)bottomRightPoint inFrame:(NSRect)frame
{
    NSSize sourceSize = [sourceImage size];

    // Top left
    NSRect topLeftTileRect = NSMakeRect(0, 0, topLeftPoint.x, sourceSize.height - topLeftPoint.y);
    NSRect topLeftCutRect = NSMakeRect(0, topLeftPoint.y, topLeftTileRect.size.width, topLeftTileRect.size.height);

    // TopRight
    NSRect topRightTileRect = NSMakeRect(0,0, sourceSize.width - bottomRightPoint.x, topLeftTileRect.size.height);
    NSRect topRightCutRect = NSMakeRect(sourceSize.width - topRightTileRect.size.width, topLeftPoint.y, topRightTileRect.size.width, topRightTileRect.size.height);

    // Top
    NSRect topTileRect = NSMakeRect(0, 0, sourceSize.width - topLeftTileRect.size.width - topRightTileRect.size.width, topLeftTileRect.size.height);
    NSRect topCutRect = NSMakeRect(topLeftPoint.x, topLeftPoint.y, topTileRect.size.width, topTileRect.size.height);

    // Bottom Left
    NSRect bottomLeftTileRect = NSMakeRect(0, 0, topLeftCutRect.size.width, bottomRightPoint.y);
    NSRect bottomLeftCutRect = NSMakeRect(0, 0, bottomLeftTileRect.size.width, bottomLeftTileRect.size.height);

    // Bottom Right
    NSRect bottomRightTileRect = NSMakeRect(0,0, topRightCutRect.size.width, bottomLeftTileRect.size.height);
    NSRect bottomRightCutRect = NSMakeRect(topRightCutRect.origin.x, 0, bottomRightTileRect.size.width , bottomRightTileRect.size.height );

    // Bottom
    NSRect bottomTileRect = NSMakeRect(0,0, topTileRect.size.width, bottomLeftTileRect.size.height);
    NSRect bottomCutRect = NSMakeRect(topCutRect.origin.x, 0, bottomTileRect.size.width, bottomTileRect.size.height);

    // left

    NSRect leftTileRect = NSMakeRect(0, 0, bottomLeftTileRect.size.width, sourceSize.height - topTileRect.size.height - bottomTileRect.size.height);
    NSRect leftCutRect = NSMakeRect(0, bottomRightPoint.y, leftTileRect.size.width, leftTileRect.size.height);

    // right

    NSRect rightTileRect = NSMakeRect(0, 0, topRightCutRect.size.width, leftCutRect.size.height);
    NSRect rightCutRect = NSMakeRect(bottomRightPoint.x, bottomRightPoint.y, rightTileRect.size.width, rightTileRect.size.height);

    //center
    NSRect centerTileRect = NSMakeRect(0, 0, topTileRect.size.width, leftTileRect.size.height);
    NSRect centerCutRect = NSMakeRect(topCutRect.origin.x, bottomRightPoint.y, centerTileRect.size.width, centerTileRect.size.height);

    NSImage *topLeft = [[NSImage alloc] initWithSize:topLeftTileRect.size];
    [topLeft lockFocus];
    [sourceImage drawInRect:topLeftTileRect fromRect:topLeftCutRect operation:NSCompositeCopy fraction:1.0];
    [topLeft unlockFocus];

    NSImage *top = [[NSImage alloc] initWithSize:topTileRect.size];
    [top lockFocus];
    [sourceImage drawInRect:topTileRect fromRect:topCutRect operation:NSCompositeCopy fraction:1.0];
    [top unlockFocus];

    NSImage *topRight = [[NSImage alloc] initWithSize:topRightTileRect.size];
    [topRight lockFocus];
    [sourceImage drawInRect:topRightTileRect fromRect:topRightCutRect operation:NSCompositeCopy fraction:1.0];
    [topRight unlockFocus];

    //setup center section, left, right
    NSImage *left = [[NSImage alloc] initWithSize:leftTileRect.size];
    [left lockFocus];
    [sourceImage drawInRect:leftTileRect fromRect:leftCutRect operation:NSCompositeCopy fraction:1.0];
    [left unlockFocus];

    NSImage *center = [[NSImage alloc] initWithSize:centerTileRect.size];
    [center lockFocus];
    [sourceImage drawInRect:centerTileRect fromRect:centerCutRect operation:NSCompositeCopy fraction:1.0];
    [center unlockFocus];

    NSImage *right = [[NSImage alloc] initWithSize:rightTileRect.size];
    [right lockFocus];
    [sourceImage drawInRect:rightTileRect fromRect:rightCutRect operation:NSCompositeCopy fraction:1.0];
    [right unlockFocus];

    NSImage *bottomLeft = [[NSImage alloc] initWithSize:bottomLeftTileRect.size];
    [bottomLeft lockFocus];
    [sourceImage drawInRect:bottomLeftTileRect fromRect:bottomLeftCutRect operation:NSCompositeCopy fraction:1.0];
    [bottomLeft unlockFocus];

    NSImage *bottom = [[NSImage alloc] initWithSize:bottomTileRect.size];
    [bottom lockFocus];
    [sourceImage drawInRect:bottomTileRect fromRect:bottomCutRect operation:NSCompositeCopy fraction:1.0];
    [bottom unlockFocus];

    NSImage *bottomRight = [[NSImage alloc] initWithSize:bottomRightTileRect.size];
    [bottomRight lockFocus];
    [sourceImage drawInRect:bottomRightTileRect fromRect:bottomRightCutRect operation:NSCompositeCopy fraction:1.0];
    [bottomRight unlockFocus];

    NSDrawNinePartImage(
                        frame,
                        topLeft, top, topRight,
                        left, center, right,
                        bottomLeft, bottom, bottomRight,
                        NSCompositeSourceOver, 1.0, NO);

    [topLeft release];
    [top release];
    [topRight release];
    [left release];
    [center release];
    [right release];
    [bottomLeft release];
    [bottom release];
    [bottomRight release];
}

@end</pre>

<p>To use this generic classes, you simply need to import it where required:</p>

<pre lang="objc">#import "GTDrawImage.h"</pre>

<p>...and then you can call from within, for example the drawRect:, selector using the following method:</p>

<pre lang="objc">- (void)drawRect:(NSRect)rect {
    [GTDrawImage drawScalableImage:baseImage scaleTopLeft:NSMakePoint(8, 16) scaleBottomRight:NSMakePoint(16,8) inFrame: [self bounds]];
}</pre>

<p>drawScalableImage takes an NSImage, in this case baseImage, and two reference points (NSPoint) to split the image into nine slices, firstly the scaleTopLeft: and secondly the scaleBottomRight:, both located from the bottom left corner. So for example to split a 24px x 24px image into 9 equal 8px by 8px segments (see below), the topLeftPoint would be x=8px, y=16px and the bottom x=16 and y=8.</p>

<p><img class="s3-img" src="http://clockobj.co.uk.s3.amazonaws.com/scale9.png" border="0" alt="scale9.png" /></p>

<p>Just download the following classes into your projects and away you go:</p>

<ul>
<li>Header: <a class="s3-link" href="http://clockobj.co.uk.s3.amazonaws.com/GTDrawImage.h">GTDrawImage.h</a></li>
<li>Implementation: <a class="s3-link" href="http://clockobj.co.uk.s3.amazonaws.com/GTDrawImage.m">GTDrawImage.m</a></li>
<li>Sample Project using GTDrawImage: <a class="s3-link" href="http://clockobj.co.uk.s3.amazonaws.com/StretchMyView.zip">StretchMyView.zip</a> (Adapted example I found. Unfortunately I can't remember where and so don't know who to credit)</li>
</ul>

</div>

			
          </div>
          </section>
			
          <footer id="footer-global" role="contentinfo" class="clearfix">
	
		<section id="contact">
		
			<div class="container">
			
				<div class="row">
		
					<div class="sixteen columns">
					
						<div class="icon-holder contact">
							<i class="icon-envelope"></i>
						</div>
						
						<h1>Got a great idea? Lets talk.</h1>
						
						<p>Please get in touch with us, we promise we won't bite!</p>
					
						<address id="contact-details">
						
							<p><a href="mailto:hello@gotripod.com?Subject=Ok, don't bite me! But I would like to talk about ...">hello@gotripod.com</a> // <a href="tel:08454752487">0845 475 2487</a><br />
							Tremough Innovation Centre, Penryn Campus
							<br>
							 Penryn, Cornwall, UK, TR10 9TA</p>
						
						</address>
                        
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d40886.830442687766!2d-5.127996999999958!3d50.17185400000002!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x486b16307846c97b%3A0x6b783d3b216b6f4d!2sGo+Tripod+Ltd!5e0!3m2!1sen!2s!4v1398110943195" width="100%" height="300" frameborder="0" style="border:0"></iframe>
                    
					</div>		
					
				</div><!-- end .row -->
			
				<div class="row">
				
					<div class="sixteen columns">
					
						<ul class="social-icons footer">
						
							<li><a href="http://www.twitter.com/gotripod" target="_blank" title="go Tripod on Twitter"><img src="assets/img/social-icons/twitter_icon_small.png" width="32" height="32" alt="" /></a></li>
							<li><a href="http://www.facebook.com/gotripod" target="_blank" title="go Tripod on Facebook"><img src="assets/img/social-icons/facebook_icon_small.png" width="32" height="32" alt="" /></a></li>
							<li><a href="http://www.linkedin.com/company/go-tripod-ltd" target="_blank" title="Go Tripod on LinkedIn"><img src="assets/img/social-icons/linkedin_icon_small.png" width="32" height="32" alt="" /></a></li>
							<li><a href="https://plus.google.com/u/0/b/101897321380998049253/101897321380998049253/posts" target="_blank" title="go Tripod on Google +"><img src="assets/img/social-icons/google_plus_icon_small.png" width="32" height="32" alt="" /></a></li>
							
						</ul>
						
					</div>
					
				</div><!-- end .row -->
		
				<div class="row">
		
					<div class="sixteen columns">
				  	  
			  			<p id="copyright-details">&copy; 2014	 Go Tripod.<br>Registered in the UK company number 6912029 VAT No. 972 5228 06</p>
             		
			  		</div>
			  		
			  	</div><!-- end .row -->	  
		  	
			</div><!-- end .container -->
		
		</section><!-- end #contact -->
		
	</footer><!-- end #footer-global -->

    </body>
</html>
