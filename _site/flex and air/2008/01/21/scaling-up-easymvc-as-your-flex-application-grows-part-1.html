<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>The Go Tripod Blog</title>
        <meta name="viewport" content="width=device-width">

       <!-- CSS (Stylesheets)
        ================================================== -->
    
        <link rel="stylesheet" href="assets/css/style.css">
        <link rel="stylesheet" href="assets/css/font-awesome.css">
        
        <!-- Google Web Fonts
        ================================================== -->
        
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Oswald">
        <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Cabin">
        
        <!-- Favicons
        ================================================== -->
       
        

    </head>
    <body>

        <div class="site">
          <div class="header">
            <nav id="header-navigation" class="sixteen columns" role="navigation">
            
              <ul id="navigation">
                  <li><a href="index.html#header-global" title="Home">Home</a></li>
                  <li><a href="index.html#introduction" title="About Us">About Us</a></li>
                  <li><a href="index.html#latest-work" title="Our Work">Our Work</a></li>
                  <li><a href="index.html#services" title="Our Services">Our Services</a></li>
                  <li><a href="index.html#meet-the-team" title="Meet the Team">Meet the team</a></li>
                <li><a href="#" title="Blog">Blog</a></li>
                  <li><a href="index.html#contact" title="Contact Us">Contact Us</a></li>
              </ul>
              
              <select name="dropdown" size="1" onChange="scrollTo(this.value)">
                  <option value="" selected="selected">Navigation</option>
                  <option value="index.html#header-global">Home</option>
                  <option value="index.html#introduction">About Us</option>
                  <option value="index.html#latest-work">Our Work</option> 
                  <option value="index.html#services">Our Services</option> 
                  <option value="index.html#meet-the-team">Meet the team</option>
                  <option value="#">Blog</option>
                  <option value="index.html#contact">Contact Us</option>
              </select>
              
			</nav><!-- end #header-navigation -->
          </div>
		
        <section id="blog">
          <div class="container" style="margin-bottom:30px;">
			
				<div class="icon-holder intro" style="margin:0 auto;">
					<i class="icon-book" style="color:#e47c14 !important;"></i>
				</div>
			
          <h2>Scaling up EasyMVC as your Flex application grows (Part 1)</h2>
<p class="meta">21 Jan 2008</p>

<div class="post">
<p><a href="http://www.gotripod.com/2007/10/17/simplified-cairngorm-easy-mvc-for-adobe-flex/">EasyMVC</a> is an excellent, easy to use Model View Controller architecture for Adobe Flex designed by <a href="http://www.tombray.com">Tom Bray</a> from <a href="http://www.chatopica.com">Chatopica</a>. However as your apps grow you may find yourself outgrowing this architecture. For example as all your event handlers are centralised into one class, this class may get to large to maintain, especially as the team maintaining the app also expands.One of the best solutions I have found to handling a growing controller is to borrow the command pattern from <a href="http://labs.adobe.com/wiki/index.php/Cairngorm">Cairngorm </a>which uses the Command design pattern.</p>

<p>Note if you have not read my previous article on EasyMVC, <a href="http://www.gotripod.com/2007/10/17/simplified-cairngorm-easy-mvc-for-adobe-flex/">click to read it here first</a>.</p>

<p>What Cairngorm does is to move these centralised event handlers from the controller into separate "command" classes. In a simple sense we are putting each of these event handlers into their own separate classes that contains just that event handler and and services the command uses. We could simply copy and paste the event handlers over as they are, initialise the class and pass the handler function (it will need to be public) within the class as the event handler. However, we want to make our lives a bit easier and this is where the command design pattern comes in.</p>

<pre line="1" lang="actionscript">
package com.clockobj.gotidal.controller{import flash.events.Event;

import mx.core.UIComponent;

import mx.events.FlexEvent;

public class GoTidalController extends UIComponent {

private var am:AppModel = AppModel.getInstance();

public function GoTidalController() {

      addEventListener( FlexEvent.CREATION_COMPLETE, setupEventListeners );

    }

private function setupEventListeners( event:Event):void {

      systemManager.addEventListener(AppEvent.COUNTRYCHANGED, countryChanged);

    }

// Country Changed

private function countryChanged(e:AppEvent):void {

      am.setCountry(e.data);

    }

  }

}</pre>

<p>Above we have an example of an EasyMVC controller which extends the UIComponent and then adds our centralised event handlers to the system manager (which can see all application events through bubbling). In this example, we have a single event handler called countryChanged which stores the changed data (passed by the event) into the AppModel (Singleton model) but as our application grows we could end up with tens if not hundreds of commands.</p>

<p>Cairngorm's strength is toe move these commands out into their own classes as discussed above. I like to create an interface definition for this class so that all commands are standard and then I can write a method to handle registering the class as an event listener on the systemManager class.</p>

<p>I use the following interface:</p>

<pre line="1" lang="actionscript">
package com.triggersoft.core.emvc{  import flash.events.Event;

public interface IEMVCCommand

  {

    function execute(e:Event):void;

  }

}</pre>

<p>Then any commands we create we need to implement this interface:</p>

<pre line="1" lang="actionscript">
package com.clockobj.gotidal.controller.commands{  import flash.events.Event;  public class CountryChangedCommand implements IEMVCCommand

  {

    public function execute(event:Event):void

    {

      AppModel.getInstance().setCountry(event.data);

    }

  }

}</pre>

<p>Then rather than having to keep initialising the new command and then adding the command as an event listener as follows:</p>

<pre line="1" lang="actionscript">
private function setupEventListeners( event:Event):void {

  var countryChangedCmd:CountryChangedCommand = new CountryChangedCommand();

  systemManager.addEventListener(AppEvent.COUNTRYCHANGED, countryChangedCmd.execute());

}</pre>

<p>We can create a function to do this for us, making use of the interface definition we created:</p>

<pre line="1" lang="actionscript">
private function addCommand(eventType:String, cmd:IEMVCCommand) {

  systemManager.addEventListener(eventType, cmd.execute());

}</pre>

<p>And in our event controller simplify it so that commands are added using our addCommand function</p>

<pre line="1" lang="actionscript">
private function setupEventListeners( event:Event):void {

  addCommand(AppEvent.COUNTRYCHANGED, new countryChangedCmd());

}</pre>

<p>With this solution we borrow how Cairngorm handles events and have a scalable Controller where each handler is in it's own command class and the controller is only used to register these commands as eventListeners on the systemManager class..</p>

<p>Taking this idea further, I like to create a EMVCController class which I then extend. i.e. the EMVCController has the addCommand method in it and it extends UIComponent and my Flex's application controller has to simply extend EMVCController instead of UIComponent as was done previously and I inherit the addCommand method so don't have to write it for each project.</p>

<p><a href="http://www.gotripod.com/2008/03/04/scaling-up-easymvc-as-your-flex-application-grows-part-2-services/">In part 2 I will look at how we share web / http services between commands.</a></p>

</div>

			
          </div>
          </section>
			
          <footer id="footer-global" role="contentinfo" class="clearfix">
	
		<section id="contact">
		
			<div class="container">
			
				<div class="row">
		
					<div class="sixteen columns">
					
						<div class="icon-holder contact">
							<i class="icon-envelope"></i>
						</div>
						
						<h1>Got a great idea? Lets talk.</h1>
						
						<p>Please get in touch with us, we promise we won't bite!</p>
					
						<address id="contact-details">
						
							<p><a href="mailto:hello@gotripod.com?Subject=Ok, don't bite me! But I would like to talk about ...">hello@gotripod.com</a> // <a href="tel:08454752487">0845 475 2487</a><br />
							Tremough Innovation Centre, Penryn Campus
							<br>
							 Penryn, Cornwall, UK, TR10 9TA</p>
						
						</address>
                        
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d40886.830442687766!2d-5.127996999999958!3d50.17185400000002!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x486b16307846c97b%3A0x6b783d3b216b6f4d!2sGo+Tripod+Ltd!5e0!3m2!1sen!2s!4v1398110943195" width="100%" height="300" frameborder="0" style="border:0"></iframe>
                    
					</div>		
					
				</div><!-- end .row -->
			
				<div class="row">
				
					<div class="sixteen columns">
					
						<ul class="social-icons footer">
						
							<li><a href="http://www.twitter.com/gotripod" target="_blank" title="go Tripod on Twitter"><img src="assets/img/social-icons/twitter_icon_small.png" width="32" height="32" alt="" /></a></li>
							<li><a href="http://www.facebook.com/gotripod" target="_blank" title="go Tripod on Facebook"><img src="assets/img/social-icons/facebook_icon_small.png" width="32" height="32" alt="" /></a></li>
							<li><a href="http://www.linkedin.com/company/go-tripod-ltd" target="_blank" title="Go Tripod on LinkedIn"><img src="assets/img/social-icons/linkedin_icon_small.png" width="32" height="32" alt="" /></a></li>
							<li><a href="https://plus.google.com/u/0/b/101897321380998049253/101897321380998049253/posts" target="_blank" title="go Tripod on Google +"><img src="assets/img/social-icons/google_plus_icon_small.png" width="32" height="32" alt="" /></a></li>
							
						</ul>
						
					</div>
					
				</div><!-- end .row -->
		
				<div class="row">
		
					<div class="sixteen columns">
				  	  
			  			<p id="copyright-details">&copy; 2014	 Go Tripod.<br>Registered in the UK company number 6912029 VAT No. 972 5228 06</p>
             		
			  		</div>
			  		
			  	</div><!-- end .row -->	  
		  	
			</div><!-- end .container -->
		
		</section><!-- end #contact -->
		
	</footer><!-- end #footer-global -->

    </body>
</html>
